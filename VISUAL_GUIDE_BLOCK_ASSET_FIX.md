# Visual Guide: Block/Asset Separation Architecture

## Architecture Flow Diagram

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                         KENNY BLOCKS EDITOR (Export)                         â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

BEFORE (âŒ BROKEN):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                               â”‚
â”‚  placedBlocks[]      placedAssets[]                                           â”‚
â”‚    â”œâ”€ Block 1          â”œâ”€ Tree 1                                             â”‚
â”‚    â”œâ”€ Block 2          â”œâ”€ Rock 1       â”€â”€â”€â”€â”€â”                                â”‚
â”‚    â””â”€ Block 3          â””â”€ Plant 1            â”‚                                â”‚
â”‚       â”‚                   â”‚                   â”‚                                â”‚
â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                   â”‚                                â”‚
â”‚                     â”‚                         â”‚                                â”‚
â”‚              MERGE ALL â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                â”‚
â”‚              GEOMETRY                                                          â”‚
â”‚                     â”‚                                                          â”‚
â”‚              â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”                                                   â”‚
â”‚              â”‚ Single GLB   â”‚        RESULT: Tree inside block! âŒ             â”‚
â”‚              â”‚  (merged)    â”‚                                                  â”‚
â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                  â”‚
â”‚                                                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

AFTER (âœ… FIXED):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                               â”‚
â”‚  placedBlocks[]                    placedAssets[]                             â”‚
â”‚    â”œâ”€ Block 1                        â”œâ”€ Tree 1  â”€â”€â”€â”€â”                        â”‚
â”‚    â”œâ”€ Block 2  â”€â”€â”€â”€â”€â”                â”œâ”€ Rock 1  â”€â”€â”€â”€â”¼â”€ Export Individual     â”‚
â”‚    â””â”€ Block 3  â”€â”€â”  â”‚                â””â”€ Plant 1 â”€â”€â”€â”€â”¤   GLBs                 â”‚
â”‚       â”‚          â”‚  â”‚                             â”Œâ”€â”€â”˜   â”œâ”€ asset_glb_001    â”‚
â”‚       â”‚          â”‚  â”œâ”€ Merge Blocks Only          â”‚       â”œâ”€ asset_glb_002    â”‚
â”‚       â”‚          â”‚  â”‚                             â”‚       â””â”€ asset_glb_003    â”‚
â”‚       â”‚          â”‚  â–¼                             â”‚                           â”‚
â”‚       â”‚          â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚                           â”‚
â”‚       â”‚          â”‚  â”‚ Block Collision â”‚           â”‚                           â”‚
â”‚       â”‚          â”‚  â”‚   Mesh (GLB)    â”‚           â”‚                           â”‚
â”‚       â”‚          â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜           â”‚                           â”‚
â”‚       â”‚          â”‚               â”‚                 â”‚                           â”‚
â”‚       â”‚          â”‚  quest_collisions_blocks       â”‚                           â”‚
â”‚       â”‚          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€            â”‚                           â”‚
â”‚       â”‚                                            â”‚                           â”‚
â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                           â”‚
â”‚                                                                               â”‚
â”‚  RESULT: Separate storage âœ…                                                  â”‚
â”‚  â€¢ Blocks: Single collision mesh                                              â”‚
â”‚  â€¢ Assets: Individual GLBs (can control rendering)                             â”‚
â”‚                                                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Local Storage Layout

```
BEFORE (âŒ):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ quest_collisions_merged         â”‚ â† Everything merged, can't separate
â”‚ â”œâ”€ Block 1 geometry             â”‚
â”‚ â”œâ”€ Block 2 geometry             â”‚
â”‚ â”œâ”€ Tree 1 geometry              â”‚ âŒ Can't render tree above block
â”‚ â”œâ”€ Rock 1 geometry              â”‚
â”‚ â””â”€ Plant 1 geometry             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

AFTER (âœ…):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ COLLISION MESH           â”‚
â”‚ â”œâ”€ Block 1               â”‚
â”‚ â”œâ”€ Block 2               â”‚
â”‚ â””â”€ Block 3               â”‚
â”‚ â†’ quest_collisions_blocksâ”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ASSET 1 (Tree)           â”‚
â”‚ â†’ asset_glb_001          â”‚ âœ… Can load separately
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ASSET 2 (Rock)           â”‚
â”‚ â†’ asset_glb_002          â”‚ âœ… Can render separately
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ASSET 3 (Plant)          â”‚
â”‚ â†’ asset_glb_003          â”‚ âœ… Can control z-order
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Rendering Pipeline

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                         KENNY DEMO (Rendering)                               â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

BEFORE (âŒ):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                               â”‚
â”‚  Load: quest_collisions_merged                                                â”‚
â”‚    â”‚                                                                           â”‚
â”‚    â”œâ”€ Parse GLB                                                               â”‚
â”‚    â”‚   â””â”€ Single mesh (blocks + assets merged)                                â”‚
â”‚    â”‚                                                                           â”‚
â”‚    â””â”€ Add to scene                                                            â”‚
â”‚        â””â”€ Single mesh rendered at same depth                                  â”‚
â”‚           â””â”€ Tree cannot appear above block âŒ                                â”‚
â”‚                                                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

AFTER (âœ…):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                               â”‚
â”‚  Phase 1: Load Collision                                                      â”‚
â”‚  â”œâ”€ Load: quest_collisions_blocks                                             â”‚
â”‚  â””â”€ Add to scene (renderOrder = 0)                                            â”‚
â”‚                                                                               â”‚
â”‚  Phase 2: Load Assets                                                         â”‚
â”‚  â”œâ”€ Load: asset_glb_001 (Tree)                                                â”‚
â”‚  â”œâ”€ Apply: renderOrder = 10 âœ… ABOVE blocks                                   â”‚
â”‚  â”œâ”€ Add to scene                                                              â”‚
â”‚  â”‚                                                                             â”‚
â”‚  â”œâ”€ Load: asset_glb_002 (Rock)                                                â”‚
â”‚  â”œâ”€ Apply: renderOrder = 10 âœ… ABOVE blocks                                   â”‚
â”‚  â”œâ”€ Add to scene                                                              â”‚
â”‚  â”‚                                                                             â”‚
â”‚  â””â”€ Load: asset_glb_003 (Plant)                                               â”‚
â”‚     â”œâ”€ Apply: renderOrder = 10 âœ… ABOVE blocks                                â”‚
â”‚     â””â”€ Add to scene                                                           â”‚
â”‚                                                                               â”‚
â”‚  Phase 3: Render with Proper Z-Order âœ…                                       â”‚
â”‚  â”œâ”€ Z = 0 (back):  Block collision mesh                                       â”‚
â”‚  â”œâ”€ Z = 10:        Tree asset                                                 â”‚
â”‚  â”œâ”€ Z = 10:        Rock asset                                                 â”‚
â”‚  â”œâ”€ Z = 10:        Plant asset                                                â”‚
â”‚  â””â”€ Z = 20:        Player character                                           â”‚
â”‚                                                                               â”‚
â”‚  RESULT: Perfect depth ordering âœ…                                            â”‚
â”‚                                                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## RenderOrder Hierarchy

```
Player View (Top-down isometric):

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  renderOrder = 30: UI Overlays       â”‚ â—„â”€â”€â”€ Closest to camera
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
  â”‚  â”‚ renderOrder = 20: Player/NPCs     â”‚â”‚
  â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚â”‚
  â”‚  â”‚ â”‚ renderOrder = 10: Assets â—„â”€ âœ… â”‚â”‚ Tree rendered ABOVE blocks
  â”‚  â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚â”‚ â”‚
  â”‚  â”‚ â”‚ â”‚ renderOrder = 0: Blocksâ”‚â”‚  â”‚â”‚ â”‚
  â”‚  â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚â”‚  â”‚â”‚ â”‚
  â”‚  â”‚ â”‚ â”‚ â”‚ Ground/Terrain   â”‚   â”‚â”‚  â”‚â”‚ â”‚
  â”‚  â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚â”‚  â”‚â”‚ â”‚
  â”‚  â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚â”‚ â”‚
  â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â—„â”€â”€â”€ Away from camera

  Code Example:
  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  mesh.renderOrder = 0    â† Block collision mesh
  mesh.renderOrder = 10   â† Asset (tree) - renders above
  mesh.renderOrder = 20   â† Character
  mesh.renderOrder = 30   â† UI overlay
```

---

## Before/After Scene Comparison

```
SCENE VIEW (Bird's Eye):

BEFORE (âŒ):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Block 1 â”‚  â”Œâ”€â†’ â”‚   MERGED â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚   MESH   â”‚   â”‚
â”‚               â”‚   â”‚   (All)  â”‚   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚          â”‚   â”‚
â”‚  â”‚ Block 2 â”‚  â”‚   â”‚  âŒ Can'tâ”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚ separate â”‚   â”‚
â”‚               â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  ğŸŒ² Tree      â”‚                  â”‚
â”‚  ğŸ’ Rock      â””â”€ Mixed together  â”‚
â”‚  ğŸŒ¿ Plant                        â”‚
â”‚                                  â”‚
â”‚  Result: Tree appears inside     â”‚
â”‚  block, proper layout impossible â”‚
â”‚                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

AFTER (âœ…):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                  â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚     â”‚  ğŸŒ² Tree (renderOrderâ”‚ 10) â”‚ â—„â”€ ABOVE
â”‚     â”‚  ğŸ’ Rock (renderOrderâ”‚ 10) â”‚
â”‚     â”‚  ğŸŒ¿ Plant(renderOrderâ”‚ 10) â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Block 1 â”‚      â”‚ Block 2 â”‚   â”‚
â”‚  â”‚(order 0)â”‚      â”‚(order 0)â”‚   â”‚ â—„â”€ BELOW
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                  â”‚
â”‚  Result: Perfect spatial         â”‚
â”‚  arrangement, proper visual orderâ”‚
â”‚                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Data Flow: Export to Render

```
EXPORT PHASE (KennyBlocksPage):
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  User Places:
  â”œâ”€ Block at (0,0,0)
  â”œâ”€ Block at (0,0,2)
  â”œâ”€ Tree at (2,0,0)
  â”œâ”€ Rock at (4,0,0)
  â””â”€ Plant at (6,0,0)

        â–¼

  handleNext() executes:

  â”œâ”€ Extract Block Geometries
  â”‚  â”œâ”€ Block 1 BoxGeo
  â”‚  â””â”€ Block 2 BoxGeo
  â”‚
  â”œâ”€ Export Assets Individually
  â”‚  â”œâ”€ Load Tree â†’ Export â†’ asset_glb_001 âœ…
  â”‚  â”œâ”€ Load Rock â†’ Export â†’ asset_glb_002 âœ…
  â”‚  â””â”€ Load Plant â†’ Export â†’ asset_glb_003 âœ…
  â”‚
  â”œâ”€ Merge Blocks Only
  â”‚  â””â”€ Block 1 + Block 2 â†’ quest_collisions_blocks âœ…
  â”‚
  â””â”€ Save to localStorage âœ…

        â–¼

localStorage state:
â”œâ”€ quest_collisions_blocks  (GLB - blocks only)
â”œâ”€ asset_glb_001            (GLB - tree)
â”œâ”€ asset_glb_002            (GLB - rock)
â”œâ”€ asset_glb_003            (GLB - plant)
â”œâ”€ placed_blocks_data       (JSON metadata)
â””â”€ placed_assets_data       (JSON metadata)


RENDER PHASE (KennyDemoPage):
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  Component Mounts:
  â”œâ”€ useEffect triggers
  â”‚  â””â”€ Detects export data in localStorage
  â”‚
  â”œâ”€ Load Collision Mesh
  â”‚  â”œâ”€ Get: quest_collisions_blocks
  â”‚  â””â”€ Parse GLB
  â”‚      â””â”€ AddToScene (renderOrder = 0)
  â”‚
  â”œâ”€ Load Assets
  â”‚  â”œâ”€ Get: asset_glb_001
  â”‚  â”œâ”€ Parse GLB
  â”‚  â”œâ”€ Set renderOrder = 10 âœ…
  â”‚  â””â”€ AddToScene
  â”‚
  â”œâ”€ Load Assets
  â”‚  â”œâ”€ Get: asset_glb_002
  â”‚  â”œâ”€ Parse GLB
  â”‚  â”œâ”€ Set renderOrder = 10 âœ…
  â”‚  â””â”€ AddToScene
  â”‚
  â””â”€ Load Assets
     â”œâ”€ Get: asset_glb_003
     â”œâ”€ Parse GLB
     â”œâ”€ Set renderOrder = 10 âœ…
     â””â”€ AddToScene

        â–¼

  Three.js Renders:
  â”œâ”€ Pass 1: renderOrder 0 (Blocks)
  â”‚  â””â”€ Block 1 + Block 2 rendered
  â”‚
  â”œâ”€ Pass 2: renderOrder 10 (Assets)  âœ… ABOVE blocks
  â”‚  â”œâ”€ Tree rendered ABOVE blocks
  â”‚  â”œâ”€ Rock rendered ABOVE blocks
  â”‚  â””â”€ Plant rendered ABOVE blocks
  â”‚
  â””â”€ Result: Perfect visual hierarchy âœ…
```

---

## Troubleshooting Visual Reference

```
SYMPTOM                      CAUSE                   FIX
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Tree invisible               â”œâ”€ Not in localStorage  â””â”€ Export again
                            â”œâ”€ Wrong path           â””â”€ Check asset paths
                            â””â”€ renderOrder wrong    â””â”€ Verify it's 10

Assets inside blocks         â”œâ”€ Old merged export    â””â”€ Export with new code
                            â”œâ”€ Missing individual   â””â”€ Check asset_glb_*
                            â””â”€ renderOrder not set  â””â”€ Apply order = 10

Z-fighting (flickering)      â”œâ”€ renderOrder same     â””â”€ Use different orders
                            â””â”€ Same depth          â””â”€ Offset slightly

Blocks rendered above        â””â”€ renderOrder backward â””â”€ Blocks=0, Assets=10
assets

Can't load assets            â”œâ”€ Old export loaded    â””â”€ Try new export
                            â””â”€ Asset files missing  â””â”€ Check GLB storage
```

---

## Summary Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   THE CORE CHANGE                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  BEFORE: Blocks â”€â”€â”
                  â”œâ”€â†’ Merge All â”€â”€â†’ Single GLB â”€â”€â†’ âŒ Broken
  Assets â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  AFTER:  Blocks â”€â”€â†’ Merge Blocks â”€â”€â†’ quest_collisions_blocks
          Assets â”€â”€â†’ Export Individual â”€â”€â†’ asset_glb_* âœ… Fixed
                    â”œâ”€ Set renderOrder = 10
                    â””â”€ Assets above blocks

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   THE RESULT                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  ğŸ® Game now works correctly
     â”œâ”€ Assets spawn at correct positions âœ…
     â”œâ”€ Assets render above blocks âœ…
     â”œâ”€ Proper visual hierarchy âœ…
     â””â”€ Backward compatible âœ…
```

---

**Created:** January 22, 2026  
**For:** Understanding block/asset architecture separation
